summary: Integration tests for openjdk-21-jdk-headless

environment:
  SLICE/bins: "bins"
  SLICE/modules: "modules"

execute: |
  # Test different slice installations
  echo "SLICE=${SLICE}"
  ARCH=`dpkg-architecture -q DEB_HOST_ARCH`
  JAVA_HOME=/usr/lib/jvm/java-21-openjdk-${ARCH}/
  rootfs="$(install-slices openjdk-21-jdk-headless_${SLICE})"
  chroot ${rootfs} ${JAVA_HOME}/bin/java --version

  # modules slice should allow to jlink an image
  if [ ${SLICE} -eq "modules" ]; then
    mkdir -p ${rootfs}/opt/java
    chroot ${rootfs} ${JAVA_HOME}/bin/jlink --add-modules java.base --output ${rootfs}/opt/java
  fi
